<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">
    <changeSet author="Gregory (generated)" id="1489679425652-1">
        <createTable tableName="house_conso">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="date_conso" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="house_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="kwhc" type="FLOAT8">
                <constraints nullable="false"/>
            </column>
            <column name="kwhp" type="FLOAT8">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-2">
        <createTable tableName="house_mode">
            <column name="house_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="mode_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-3">
        <addPrimaryKey columnNames="id" constraintName="house_conso_pkey" tableName="house_conso"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-4">
        <addPrimaryKey columnNames="house_id, mode_id" constraintName="house_mode_pkey" tableName="house_mode"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-5">
        <addUniqueConstraint columnNames="date_conso, house_id" constraintName="unique_house_id" deferrable="false" disabled="false" initiallyDeferred="false" tableName="house_conso"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-6">
        <addForeignKeyConstraint baseColumnNames="mode_id" baseTableName="house_mode" constraintName="fk_4xfw1euybn4tedme3tec8cnuq" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="mode"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-7">
        <addForeignKeyConstraint baseColumnNames="house_id" baseTableName="house_conso" constraintName="fk_8an7omec7wwt4tjjx0ot1o6vh" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="house"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-8">
        <addForeignKeyConstraint baseColumnNames="house_id" baseTableName="house_mode" constraintName="fk_n6t5i62plvx3hugwa2mkg4vn9" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="house"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-9">
        <createIndex indexName="houseconso_idx" tableName="house_conso" unique="false">
            <column name="house_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-10">
        <createIndex indexName="mode_user_idx" tableName="mode" unique="false">
            <column name="user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-11">
        <dropColumn columnName="conso_annuelle" tableName="house"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1489679425652-12">
        <dropColumn columnName="date_calcul_conso" tableName="house"/>
    </changeSet>
</databaseChangeLog>
